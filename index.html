<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tica-tacoe</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <article class="board">
        <table>
            <tbody>
            <tr>
                <td class="field" id="0"></td>
                <td class="field" id="1"></td>
                <td class="field" id="2"></td>
            </tr>
            <tr>
                <td class="field" id="3"></td>
                <td class="field" id="4"></td>
                <td class="field" id="5"></td>
            </tr>
            <tr>
                <td class="field" id="6"></td>
                <td class="field" id="7"></td>
                <td class="field" id="8"></td>
            </tr>
            </tbody>
        </table>
    </article>
    <script>
        const CIRCLE = 'CIRCLE';
        const CROSS = 'CROSS';
        let last = '';
        let fields = [["1", "2", "3"], ["4", "5", "6"], ["7", "8", "9"]];

        function addValueToMatrix(value, sign){
            let res;
            let slot;
            if (value <= 2){
                res = 0
                slot = value
            } else if(value >= 3 && value <= 5){
                res = 1
                slot = value - 3
            } else {
                res = 2
                slot = value - 6
            }

            return fields[res][slot] = sign
        }

        function checkHorizontalFields(){
            const [first, second, third] = fields;
            const firstWon = first.every((item, index, arr) => item === arr[0])
            const secondWon = second.every((item, index, arr) => item === arr[0])
            const thirdWon = third.every((item, index, arr) => item === arr[0])
            return firstWon || secondWon || thirdWon;
        }

        function checkVerticalFields(){
            const [first, second, third] = fields;
            for (let count = 0; count < 3; count += 1){
                console.log(count)
                return first[count] === second[count] && first[count] === third[count]
            }
        }

        function checkSideFields(){
            const [first, second, third] = fields;
            return first[0] === second[1] && first[0] === third[2] || first[2] === second[1] && first[2] === third[0]
        }


        const elems = document.querySelectorAll('td.field');
        elems.forEach(element => {
            element.addEventListener("click", (e)=> {
                if (last === '' || last === CIRCLE){
                    last = CROSS
                    addValueToMatrix(e.target.id, CROSS);
                    if(checkHorizontalFields() || checkVerticalFields() || checkSideFields()){
                        alert(`${last} WINS!!`)
                    }
                    element.innerHTML = "<img src='assets/cross.svg' alt='' width='90px' />"
                }

                if(last === CROSS) {
                    last = CIRCLE
                    addValueToMatrix(e.target.id, CIRCLE);
                    if(checkHorizontalFields() || checkVerticalFields() || checkSideFields()){
                        alert(`${last} WINS!!`)
                    }
                    element.innerHTML = "<img src='assets/circle.svg' alt='' width='90px' />"
                }
            })
        });
    </script>
</body>
</html>